<!DOCTYPE html>

<html lang="en">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta content="Expense Tracker Integration Platform " name="description" />
    <meta content="" name="author" />
    <title>@ViewBag.Title</title>

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="~/img/favicons/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="~/img/favicons/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="~/img/favicons/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="~/img/favicons/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="~/img/favicons/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="~/img/favicons/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="~/img/favicons/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="~/img/favicons/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="~/img/favicons/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="~/img/favicons/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="~/img/favicons/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="~/img/favicons/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="~/img/favicons/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="&nbsp;" />
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="~/img/favicons/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="~/img/favicons/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="~/img/favicons/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="~/img/favicons/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="~/img/favicons/mstile-310x310.png" />
    <link rel="shortcut icon" href="~/img/favicons/favicon.ico" type="image/x-icon" />
    <meta name="description" itemprop="description" content="Expense Tracker Admin portal to perform activities" />

    <meta name="keywords" itemprop="keywords" content="Expense Tracker Admin portal to perform activities" />

    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&subset=all" rel="stylesheet" type="text/css" />
    @Styles.Render("~/bundles/appseconnect/global/css", "~/bundles/layout/css")
    <style>
        #chartdiv {
            width: 100%;
            height: 435px;
            font-size: 11px;
        }
    </style>

    @Scripts.Render("~/bundles/global/js/jquery")

    <script type="text/javascript">
        var baseUrl = "/";
    </script>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    @Scripts.Render("~/bundles/global/js", "~/bundles/knockout/js", "~/bundles/global/app/js", "~/bundles/app/loaders")
    <script src="~/Content/themes30/global/plugins/bootstrap-confirmation/bootstrap-confirmation.min.js"></script>
    <link href="~/Content/themes30/global/plugins/bootstrap-toastr/toastr.min.css" rel="stylesheet" />
    <script src="~/Content/themes30/global/plugins/bootstrap-toastr/toastr.min.js"></script>
</head>
<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
    <div class="page-wrapper">
        <div class="page-header navbar navbar-fixed-top">
            <!-- BEGIN HEADER INNER -->
            <div class="page-header-inner ">
                <!-- BEGIN LOGO -->
                <div class="page-logo">
                    <a href="/">
                        <img src="~/content/logo.png" alt="logo" style="width: 208px;" class="logo-default" />
                    </a>
                    <div class="menu-toggler sidebar-toggler"> </div>
                </div>
                <!-- END LOGO -->
                <!-- BEGIN RESPONSIVE MENU TOGGLER -->
                <a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a>
                <!-- END RESPONSIVE MENU TOGGLER -->
                <!-- BEGIN TOP NAVIGATION MENU -->
                <div class="top-menu">
                    <ul class="nav navbar-nav pull-right">
                        <!-- BEGIN NOTIFICATION DROPDOWN -->
                        <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                        <li class="dropdown dropdown-extended dropdown-notification" id="header_notification_bar">
                            <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                                <i class="icon-bell"></i>
                            </a>
                            <ul class="dropdown-menu">
                                <li class="external">
                                    <h3>
                                        <span class="bold">Downloads</span>
                                    </h3>
                                </li>
                                <li>
                                    <ul class="dropdown-menu-list scroller" style="height: 250px;" data-handle-color="#637283">
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">just now</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-success">
                                                        <i class="fa fa-plus"></i>
                                                    </span> New user registered.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">3 mins</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-danger">
                                                        <i class="fa fa-bolt"></i>
                                                    </span> Server #12 overloaded.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">10 mins</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-warning">
                                                        <i class="fa fa-bell-o"></i>
                                                    </span> Server #2 not responding.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">14 hrs</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-info">
                                                        <i class="fa fa-bullhorn"></i>
                                                    </span> Application error.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">2 days</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-danger">
                                                        <i class="fa fa-bolt"></i>
                                                    </span> Database overloaded 68%.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">3 days</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-danger">
                                                        <i class="fa fa-bolt"></i>
                                                    </span> A user IP blocked.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">4 days</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-warning">
                                                        <i class="fa fa-bell-o"></i>
                                                    </span> Storage Server #4 not responding dfdfdfd.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">5 days</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-info">
                                                        <i class="fa fa-bullhorn"></i>
                                                    </span> System Error.
                                                </span>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <span class="time">9 days</span>
                                                <span class="details">
                                                    <span class="label label-sm label-icon label-danger">
                                                        <i class="fa fa-bolt"></i>
                                                    </span> Storage server failed.
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                            <!-- END NOTIFICATION DROPDOWN -->
                            <!-- BEGIN INBOX DROPDOWN -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            @if (ViewBag.CurrentHelpUrl != null)
                            {

                            <li class="dropdown dropdown-extended dropdown-notification" id="header_help_bar">
                                <a onclick="javascript:getUrlForContext();" href="#" class="dropdown-toggle"
                                   data-close-others="true" title="Get help for this page">
                                    <i class="icon-flag"></i>
                                </a>
                            </li>
                            }
                            <li class="dropdown dropdown-extended dropdown-notification">
                                <a href="#" onclick="javascript:void(0);" title="Bookmark this page" class="dropdown-toggle mt-ladda-btn ladda-button hide"
                                   data-style="zoom-in" data-close-others="true">
                                    <i class="icon-feed"></i>
                                    <span class="ladda-spinner"></span>
                                </a>
                            </li>
                            <!-- END INBOX DROPDOWN -->
                            <!-- BEGIN USER LOGIN DROPDOWN -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            <li class="dropdown dropdown-user">
                                <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
                                    <img alt="User Profile" class="img-circle" src='@(ViewBag.ProfilePic == null ? "http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" : ViewBag.ProfilePic.ToString())'>
                                    <span class="username username-hide-on-mobile"> @ViewBag.UserFullName  </span>
                                    <i class="fa fa-angle-down"></i>
                                </a>

                                <ul class="dropdown-menu dropdown-menu-default">
                                    <li>
                                        <a href="/Profile">
                                            <i class="icon-user"></i> @ViewBag.UserFullName
                                        </a>
                                    </li>
                                    <li class="divider"> </li>
                                    <li>

                                        @using (Html.BeginForm("LockOut", "Account", new { ReturnUrl = this.Request.RawUrl }, FormMethod.Post, new { id = "lockoutForm", @class = "hide" }))
                                        {
                                            @Html.AntiForgeryToken()
                                            @Html.Hidden("ReturnUrl", (object)this.Request.RawUrl.ToString())

                                        }
                                        <a href="javascript:document.getElementById('lockoutForm').submit()">
                                            <i class="icon-lock"></i> Lock Screen
                                        </a>
                                    </li>

                                    <li>

                                        @using (Html.BeginForm("LogOut", "Account", new { area = "" }, FormMethod.Post, new { id = "logoutForm", @class = "hide" }))
                                        {@Html.AntiForgeryToken()}
                                        <a href="javascript:document.getElementById('logoutForm').submit()">
                                            <i class="icon-key"></i> Log Out
                                        </a>
                                    </li>

                                </ul>
                            </li>
                            <!-- END USER LOGIN DROPDOWN -->
                            <!-- BEGIN QUICK SIDEBAR TOGGLER -->
                            <!-- DOC: Apply "dropdown-dark" class after below "dropdown-extended" to change the dropdown styte -->
                            @*<li class="dropdown dropdown-quick-sidebar-toggler">
                                    <a href="javascript:;" class="dropdown-toggle">
                                        <i class="icon-logout"></i>
                                    </a>
                                </li>*@
                            <!-- END QUICK SIDEBAR TOGGLER -->
                        </ul>
                    </div>
                    <!-- END TOP NAVIGATION MENU -->
                </div>
                <!-- END HEADER INNER -->
            </div>
            <div class="clearfix"> </div>
            <div class="page-container">
                <!-- BEGIN SIDEBAR -->
                <div class="page-sidebar-wrapper">
                    <!-- BEGIN SIDEBAR -->
                    <!-- DOC: Set data-auto-scroll="false" to disable the sidebar from auto scrolling/focusing -->
                    <!-- DOC: Change data-auto-speed="200" to adjust the sub menu slide up/down speed -->
                    <div class="page-sidebar navbar-collapse collapse">
                        <!-- BEGIN SIDEBAR MENU -->
                        <!-- DOC: Apply "page-sidebar-menu-light" class right after "page-sidebar-menu" to enable light sidebar menu style(without borders) -->
                        <!-- DOC: Apply "page-sidebar-menu-hover-submenu" class right after "page-sidebar-menu" to enable hoverable(hover vs accordion) sub menu mode -->
                        <!-- DOC: Apply "page-sidebar-menu-closed" class right after "page-sidebar-menu" to collapse("page-sidebar-closed" class must be applied to the body element) the sidebar sub menu mode -->
                        <!-- DOC: Set data-auto-scroll="false" to disable the sidebar from auto scrolling/focusing -->
                        <!-- DOC: Set data-keep-expand="true" to keep the submenues expanded -->
                        <!-- DOC: Set data-auto-speed="200" to adjust the sub menu slide up/down speed -->
                        <ul class="page-sidebar-menu  page-header-fixed " data-keep-expanded="false" data-auto-scroll="true"
                            data-slide-speed="200" style="padding-top: 20px">
                            <!-- DOC: To remove the sidebar toggler from the sidebar you just need to completely remove the below "sidebar-toggler-wrapper" LI element -->
                            <li class="sidebar-toggler-wrapper hide">
                                <!-- BEGIN SIDEBAR TOGGLER BUTTON -->
                                <div class="sidebar-toggler"> </div>
                                <!-- END SIDEBAR TOGGLER BUTTON -->
                            </li>
                            <!-- DOC: To remove the search box from the sidebar you just need to completely remove the below "sidebar-search-wrapper" LI element -->
                            <li class="sidebar-search-wrapper">
                                <!-- BEGIN RESPONSIVE QUICK SEARCH FORM -->
                                <!-- DOC: Apply "sidebar-search-bordered" class the below search form to have bordered search box -->
                                <!-- DOC: Apply "sidebar-search-bordered sidebar-search-solid" class the below search form to have bordered & solid search box -->
                                <form class="sidebar-search  " action='#' method="get">
                                    <a href="javascript:;" class="remove">
                                        <i class="icon-close"></i>
                                    </a>
                                    <div class="input-group">
                                        <input type="text" id="SearchString" name="SearchString" class="form-control" placeholder="Search..." style="color:#b4bcc8">
                                        <span class="input-group-btn">
                                            <a href="javascript:;" class="btn submit">
                                                <i class="icon-magnifier"></i>
                                            </a>
                                        </span>
                                    </div>
                                </form>
                                <!-- END RESPONSIVE QUICK SEARCH FORM -->
                            </li>


                            <li class="heading">
                                <h3 class="uppercase">Menu</h3>
                            </li>
                            @if (User.Identity.IsAuthenticated)
                            {
                                if (ViewBag.Menu != null)
                                {
                                    var menuList = ViewBag.Menu as List<Expense.Tracker.Data.EntityModel.Feature>;
                                    var groups = menuList.GroupBy(g => new { g.FeatureGroup });


                                    foreach (var group in groups)
                                    {
                                        var groupName = group.Key.FeatureGroup == null ? "Actions" : group.Key.FeatureGroup;
                                        var className = "icon-home";
                                        var firstElement = menuList.FirstOrDefault(e => e.FeatureGroup == group.Key.FeatureGroup);
                                        if (firstElement != null)
                                        {
                                            className = firstElement.FeatureStyle;
                                        }

                                        using (@Html.MenuGroupActionLink(groupName, "nav-link nav-toggle", className))
                                        {
                                            foreach (var feature in menuList.Where(e => e.FeatureGroup == group.Key.FeatureGroup))
                                            {
                                                var item = feature;
                                                string styleName = item.FeatureStyle == null ? "icon-bar-chart" : (string)item.FeatureStyle;
                                                @Html.MenuActionLink((string)item.FeatureName, (string)item.Action, (string)item.Controller, "nav-link nav-toggle", styleName, null, null)

                                            }
                                        }
                                    }

                                }
                            }
                            <li class="nav-item start ">
                                <a href="#" class="nav-link nav-toggle">
                                    <i class="icon-user"></i>
                                    <span class="title">Profile</span>
                                </a>
                                <ul class="sub-menu">
                                    <li class="nav-item start" for="Profile-">
                                        <a href="/Profile" class="nav-link nav-toggle">
                                            <i class="icon-users"></i>
                                            <span class="title">Change Details</span>
                                            <span class="selected"></span>
                                        </a>
                                    </li>
                                    <li class="nav-item start" for="Profile-">
                                        <a href="javascript:document.getElementById('lockoutForm').submit()" class="nav-link nav-toggle">
                                            <i class="icon-lock"></i>
                                            <span class="title">Lock</span>
                                            <span class="selected"></span>
                                        </a>
                                    </li>
                                    <li class="nav-item start" for="Profile-">
                                        <a href="javascript:document.getElementById('logoutForm').submit()" class="nav-link nav-toggle">
                                            <i class="icon-key"></i>
                                            <span class="title">Logout</span>
                                            <span class="selected"></span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <!-- END SIDEBAR MENU -->
                            <!-- END SIDEBAR MENU -->
                    </div>
                    <!-- END SIDEBAR -->
                </div>
                <!-- END SIDEBAR -->
                <!-- BEGIN CONTENT -->
                <div class="page-content-wrapper">
                    <!-- BEGIN CONTENT BODY -->
                    <div class="page-content">
                        <!-- BEGIN PAGE BAR -->
                        <div class="page-bar">
                            <ul class="page-breadcrumb">
                                @Html.MvcSiteMap().SiteMapPath()
                            </ul>
                            <div class="page-toolbar">
                                <div id="dashboard-report-range" class="pull-right tooltips btn btn-sm" data-container="body" data-placement="bottom" data-original-title="Change dashboard date range">
                                    <i class="icon-calendar"></i>&nbsp;
                                    <span class="thin uppercase hidden-xs">@DateTime.Now.ToLongDateString()</span>&nbsp;
                                    <i class="fa fa-angle-down"></i>
                                </div>
                            </div>
                        </div>
                        <h1 class="page-title">
                            @ViewBag.Title
                        </h1>
                        <div class="note note-info">
                            <p>
                                @if (ViewBag.PageDescription != null)
                                {
                                    @ViewBag.PageDescription
                                }
                            </p>
                        </div>
                        <div id="bodyContent">
                            @RenderBody()
                        </div>
                    </div>
                    <!-- END CONTENT BODY -->
                </div>
                <!-- END CONTENT -->
            </div>
            <!-- BEGIN FOOTER -->
            <div class="page-footer">
                <div class="page-footer-inner">
                    Expense tracking Portal. All rights reserved. 
                </div>
                <div class="pull-right" style="color: lightgray">Powered by : KMDW</div>
                <div class="scroll-to-top">
                    <i class="icon-arrow-up"></i>
                </div>
            </div>
        </div>

        @*<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
            <script src="https://www.amcharts.com/lib/3/serial.js"></script>
            <script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
            <script src="~/Content/themes30/pages/scripts/charts-amcharts.js"></script>*@
        <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>


        @RenderSection("scripts", required: false)

        <script type="text/javascript">

            var currentController = '@ViewBag.CurrentController';
            var currentAction = '@ViewBag.CurrentAction';
            var orgId = "@HttpContext.Current.Session["orgid"]";
            if (orgId != '')
                $.cookie('orgid', orgId);

            if (currentController == '')
                currentController = 'Dashboard';

            $(document).ready(function () {

                $('[for]').removeClass('active open');
                var element = $('[for^=' + currentController + '-' + ']');
                element.addClass('active open');
                element.parents().closest('li').addClass('active open');

                //init date pickers
                $('.date-picker').datepicker({
                    autoclose: true
                });

                toastr.options = {
                    "closeButton": true,
                    "debug": false,
                    "positionClass": "toast-bottom-right",
                    "onclick": null,
                    "showDuration": "1000",
                    "hideDuration": "1000",
                    "timeOut": "5000",
                    "extendedTimeOut": "1000",
                    "showEasing": "swing",
                    "hideEasing": "linear",
                    "showMethod": "fadeIn",
                    "hideMethod": "fadeOut"
                };
            });
            function getUrlForContext() {
                var url = '@ViewBag.CurrentHelpUrl';

                ajaxRequest('GET', baseUrl + 'Dashboard/GetLoginToHelpDesk?redirectTo=' + url)
                    .done(function (data, textStatus, jqXH) {
                        window.open(data);
                    })
                .error(function (e) {
                    alert('Cannot connect to help server. Please contact admin');
                });
            }

            function loguserout() {
                ajaxRequest('POST', baseUrl + 'Account/LogOut')
            }
            function DeleteBookmark(obj, bookmarkid) {
                debugger;

                var url = location.href;
                bootbox.confirm("Do you want to delete this item? ", function (result) {
                    if (result != null) {
                        ajaxRequest('DELETE', baseUrl + 'Dashboard/DeleteBookmark', { bookmarkId: bookmarkid })
                           .done(function (data, textStatus, jqXH) {
                               if (data.Success && data.Success == true) {
                                   toastr.success('We have removed the bookmark', 'Success!');
                                   $(obj).closest('li').remove();
                               }
                               else {
                                   toastr.error('Cannot bookmark the url', 'Failed!');
                               }
                           })
                       .error(function (e) {
                           toastr.error('Cannot bookmark the url', 'Failed!');

                       });
                    }
                });
                return false;
            }
            function AddBookmark(obj) {
                debugger;
                var l = Ladda.create(obj);
                l.start();
                var url = location.href;
                bootbox.prompt("Name this bookmark ", function (result) {
                    if (result === null) {
                        l.stop();
                    }
                    else {
                        ajaxRequest('POST', baseUrl + 'Dashboard/AddToBookmarks', { pageUrl: url, name: result })
                           .done(function (data, textStatus, jqXH) {
                               if (data.Success && data.Success == true) {
                                   toastr.success('We have added this link as bookmark', 'Success!');
                                   $('[role="bookmark"]').append('<li><div class="btn-group" style="width:100%"><a class="btn btn-default" style="width:80%" href="' + url + '"><i class="icon-docs"></i> ' + result + '</a> <a class="btn btn-outline red pull-right" style="width:20%"><i class="fa fa-trash-o"></i></a></div></li>');
                               }
                               else {
                                   toastr.error('The url is already bookmarked', 'Failed!');
                               }
                               l.stop();
                           })
                       .error(function (e) {
                           toastr.error('Cannot bookmark the url', 'Failed!');
                           l.stop();
                       });
                    }
                });
                return false;
            }
        </script>



    </body>


</html>
